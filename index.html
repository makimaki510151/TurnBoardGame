<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>マルチボードゲーム</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <h1>⚔️ マルチプレイヤー・ボードゲーム 🛡️</h1>
    </header>

    <section id="character-creation">
        <h2>🎨 キャラクター制作</h2>
        <div id="creation-form">
            <label for="char-name">名前:</label>
            <input type="text" id="char-name" value="勇者" required><br><br>

            <label for="char-level">レベル (1-10):</label>
            <input type="number" id="char-level" value="1" min="1" max="10" oninput="updateStatsAllocation()">
            
            <p>残りステータスポイント: <span id="remaining-points">5</span></p>
            
            <div class="stat-control">
                <label for="stat-str">筋力 (STR):</label>
                <input type="number" id="stat-str" value="1" min="1" max="10" oninput="updateStatsAllocation()">
            </div>
            <div class="stat-control">
                <label for="stat-dex">器用 (DEX):</label>
                <input type="number" id="stat-dex" value="1" min="1" max="10" oninput="updateStatsAllocation()">
            </div>
            <div class="stat-control">
                <label for="stat-vit">体力 (VIT):</label>
                <input type="number" id="stat-vit" value="1" min="1" max="10" oninput="updateStatsAllocation()">
            </div>
            <div class="stat-control">
                <label for="stat-int">知力 (INT):</label>
                <input type="number" id="stat-int" value="1" min="1" max="10" oninput="updateStatsAllocation()">
            </div>
            <div class="stat-control">
                <label for="stat-agi">敏捷 (AGI):</label>
                <input type="number" id="stat-agi" value="1" min="1" max="10" oninput="updateStatsAllocation()">
            </div>
            <div class="stat-control">
                <label for="stat-luk">幸運 (LUK):</label>
                <input type="number" id="stat-luk" value="1" min="1" max="10" oninput="updateStatsAllocation()">
            </div>
            
            <hr>
            
            <h3>スキル選択 (2つまで)</h3>
            <div class="skill-select-group">
                <label for="char-skill-1">スキル 1:</label>
                <select id="char-skill-1">
                    <option value="">スキルデータ読み込み中...</option>
                </select>
                <p id="skill-desc-1" class="skill-desc"></p>
            </div>
            <div class="skill-select-group">
                <label for="char-skill-2">スキル 2:</label>
                <select id="char-skill-2">
                    <option value="">スキルデータ読み込み中...</option>
                </select>
                <p id="skill-desc-2" class="skill-desc"></p>
            </div>
            
            <button onclick="saveCharacter()" id="save-char-btn">💾 作成キャラを保存</button>
            <button onclick="clearCharacterForm()">フォームをクリア</button>
            <input type="hidden" id="editing-char-id" value="">
        </div>
    </section>

    <hr>
    
    <section id="character-management">
        <h2>📦 保存済みキャラクター</h2>
        <p id="local-char-count">現在 0 体のキャラクターがブラウザに保存されています。</p>
        <ul id="saved-character-list">
            </ul>
        
        <p>現在ゲームに持ち込むキャラクター:</p>
        <p id="current-selected-char">**未選択**</p>
        <p id="current-selected-team">**チーム未選択**</p>
    </section>

    <hr>

    <section id="lobby-section">
        <h2>🏠 ロビーと接続 (PVP)</h2>
        
        <div id="connection-controls">
            <button onclick="hostGame()">ホストとして部屋を建てる</button> 
            <label for="server-ip">ホストのIPアドレス:</label>
            <input type="text" id="server-ip" placeholder="例: 192.168.1.100:8080">
            <button onclick="joinGame()">ゲームに参加</button>
        </div>

        <p id="connection-status">接続ステータス: 未接続</p>
        
        <div id="lobby-state-info" class="hidden">
            <hr>
            <div id="team-selection">
                <h3>チームを選択</h3>
                <button onclick="selectTeam('A')" id="btn-team-a" disabled>🔵 チーム A に参加</button>
                <button onclick="selectTeam('B')" id="btn-team-b" disabled>🔴 チーム B に参加</button>
                <p style="font-size: 0.9em; margin-top: 10px;">※ キャラクターを選択し、接続してからチームに参加してください。</p>
            </div>

            <button onclick="startGamePvP()" id="start-game-btn" class="hidden">▶️ ゲーム開始 (ホスト専用)</button>
            
            <h3>参加プレイヤー</h3>
            <ul id="player-list"></ul>
        </div>
    </section>

    <hr>

    <section id="game-board-section" class="hidden">
        <h2>🗺️ ゲーム盤面</h2>
        <div id="game-board">
            </div>

        <div id="game-info">
            <p id="current-turn">現在のターン: チームA</p>
            <p id="action-message">行動を選択してください。</p>
        </div>
        
        <div id="current-unit-stats">
            <p>移動力: <span id="display-move">0</span> / <span id="display-max-move">0</span></p>
        </div>

        <div id="action-panel" class="hidden">
            <button id="move-button" onclick="handleMoveAction()">移動</button>
            <div id="skill-buttons">
                </div>
            <button id="end-turn-button" onclick="endTurn()">ターン終了</button>
        </div>
    </section>

    <script src="script.js"></script>
</body>
</html>